{% extends "homepage/basic.html" %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block content %}
    <!-- if user doesnot select his country -->
    {% if username %}
        <!-- if user doesnot created atleast one type of account -->
        {% if bankAccounts or loanAccounts or investmentAccounts or creditCards %}
            <h2 class="fs-5"> Dashboard</h2>
            <p>Welcome {{ username }}.</p>
            <p>You are from {{ country }} and Your currency is {{ currency }}</p>
            {% for category in expensecategories %}
              <p>category : {{ category.name }} created on {{ category.created_at }}</p>
            {% endfor %}
            <div>
              <!-- add button for expense and income -->
              <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#expenseModal">
                <i class="bi bi-plus-circle"></i> Add Expense
              </button>
            </div>
            &nbsp;
            <div>
              <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#incomeModal">
                <i class="bi bi-plus-circle"></i> Add Income
              </button>
            </div>
        {% else %}
            <h2 class="fs-5"> Welcome {{ username }} </h2>
            <p>Just one more step to get started. Just create any account for adding transactions.</p>
            
            <!-- add buttons to create SavingsAccount, CheckingAccount, LoanAccount, InvestmentAccount, CreditCardAccount -->
            <div class="row g-3">
                <div class="col-sm-6 mb-3 mb-sm-0">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">Bank Account</h5>
                      <p class="card-text text-muted">With Bank Account you can track your savings or checking in your bank accounts. </p>
                      <!-- Bank Account trigger modal -->
                      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#bankAccountModal">
                        <i class="bi bi-plus-circle"></i> Add Bank Account
                      </button>
                    </div>
                  </div>
                </div>
                <div class="col-sm-6 mb-3 mb-sm-0">
                    <div class="card">
                      <div class="card-body">
                        <h5 class="card-title">Credit Cards</h5>
                        <p class="card-text text-muted">With Credit Cards you can track your spending on credit cards.</p>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#creditCardModal">
                            <i class="bi bi-plus-circle"></i> Add Credit Card
                          </button>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 mb-3 mb-sm-0">
                    <div class="card">
                      <div class="card-body">
                        <h5 class="card-title">Loan Account</h5>
                        <p class="card-text text-muted">With Loan Account you can track your loans and liabilities.</p>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#loanAccountModal">
                            <i class="bi bi-plus-circle"></i> Add Loan Account
                          </button>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-6 mb-3 mb-sm-0">
                    <div class="card">
                      <div class="card-body">
                        <h5 class="card-title">Investment Account</h5>
                        <p class="card-text text-muted">With Investment Account you can track your Investments.</p>
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#investmentAccountModal">
                            <i class="bi bi-plus-circle"></i> Add Investment Account
                          </button>
                        
                      </div>
                    </div>
                  </div>
              </div>
        {% endif %}  
    {% else %}
        <h2 class="fs-5"> Welcome to Chitta Book </h2>
        <p>It looks like this is your first time logging in. Let's get started by updating your name and currency.</p>
        <p>Thank you using Chitta Book. It will only take a few seconds to Get Started!</p>
        <!-- Button trigger modal -->
        <a class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop" href="{% url 'profileUpdate' %}">
            Click here for Getting Started
        </a>
    {% endif %}

    <!-- Add expense modal -->
    <div class="modal fade" id="expenseModal" tabindex="-1" aria-labelledby="expenseModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="expenseModalLabel">Add Expense</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="#">
                    {% csrf_token %}
                    {{ expenseForm|crispy }}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <input type="submit" value="Save Changes" class="btn btn-primary"/>
                    </div>
                </form>
        </div>
        </div>
    </div>

    <!-- Add income modal -->
    <div class="modal fade" id="incomeModal" tabindex="-1" aria-labelledby="incomeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="incomeModalLabel">Add Income</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="#">
                    {% csrf_token %}
                    {{ incomeForm|crispy }}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <input type="submit" value="Save Changes" class="btn btn-primary"/>
                    </div>
                </form>
        </div>
        </div>
    </div>


{% endblock %}